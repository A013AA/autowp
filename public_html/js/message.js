define("message",["jquery","bootstrap"],function(e,t){return{showDialog:function(t,n,r,i){var s=this,o=e('<div class="modal fade">                        <div class="modal-dialog">                            <form action="/account/send-personal-message" class="modal-content" method="post">                                <div class="modal-header">                                    <a class="close">×</a>                                    <h3 class="modal-title">Отправить личное сообщение</h3>                                </div>                                <div class="modal-body">                                    <textarea cols="65" rows="5" name="contents" placeholder="Текст сообщения" class="form-control"></textarea>                                </div>                                <div class="modal-footer">                                    <button class="btn btn-primary" data-loading-text="отправляется ..." data-complete-text="отправлено" data-send-text="отправить">отправить</button>                                    <button class="btn btn-default cancel">отменить</button>                                </div>                            </form>                        </div>                    </div>'),u=o.find("form"),a=u.find(".btn-primary").button(),f=u.find(".cancel").button(),l=u.find("textarea");n&&l.val(n),o.modal({show:!0}),o.on("hidden.bs.modal",function(){o.remove(),i&&i()}),o.on("shown.bs.modal",function(){l.focus()}),l.bind("change keyup click",function(){l.parent().removeClass("error"),a.text("отправить").removeClass("btn-success").prop("disabled",e(this).val().length<=0)}).triggerHandler("change"),u.find("button.cancel, a.close").on("click",function(e){e.preventDefault(),o.modal("hide")}),u.submit(function(e){e.preventDefault();var n=l.val();n.length<=0?l.parent().addClass("error"):(a.button("loading"),f.prop("disabled",1),l.prop("disabled",1),s.sendMessage(t,n,function(){l.val(""),a.button("reset").button("complete").addClass("btn-success disabled").prop("disabled",1),l.prop("disabled",0),f.prop("disabled",0),r&&r()}))})},sendMessage:function(t,n,r){e.post("/account/send-personal-message",{user_id:t,message:n},function(){r&&r()},"json")},deleteMessage:function(t,n){e.post("/account/delete-personal-message",{id:t},function(){n&&n()})}}});