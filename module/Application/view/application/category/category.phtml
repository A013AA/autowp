<?php
    $this->pageEnv([
        'layout' => [
            'blankPage' => false,
            'needRight' => false
        ],
        'pageTitle' => $this->car()->textTitle($this->category->toArray()),
        'pageId' => 23,
        'args'   => [
            'CATEGORY_SHORT_NAME' => $this->category->name, //$this->categoryLang ? $this->categoryLang->short_name : $this->category->short_name,
            'CATEGORY_NAME'       => $this->categoryLang ? $this->categoryLang->name : $this->category->name,
            'CATEGORY_CATNAME'    => $this->category->catname
        ],
        'breadcrumbsReplace' => [
            'pageId'      => 23,
            'breadcrumbs' => $this->breadcrumbs
        ]
    ]);
?>

<?php if ($this->user()->inheritsRole('moder')) { ?>
    <p>
        <i class="fa fa-cog"></i>
        <?=$this->htmlA($this->url('moder/cars/params', [
            'action' => 'car',
            'car_id' => $this->category['id']
        ]), $this->translate('moder/edit-object'))?>
        
        <?php if ($this->user()->isAllowed('car', 'add')) { ?>
            <i class="fa fa-plus"></i>
            <?=$this->htmlA($this->url('moder/cars/params', [
                'action'       => 'new',
                'parent_id'    => $this->category['id'],
                'item_type_id' => $this->category['item_type_id'],
            ]), $this->translate('moder/vehicle/catalogue/add-category'))?>
        <?php } ?>
    </p>
<?php } ?>

<?php if ($this->description) { ?>
    <?=$this->markdown($this->description)?>
<?php } ?>

<?=$this->partial('application/cars', $this->listData)?>
<?=$this->paginationControl($this->paginator, null, null, [
    'urlParams' => $this->urlParams
]) ?>

<?php if (count($this->contributors)) { ?>
    <p>
        <?=$this->escapeHtml($this->translate('catalogue/specifications/contributors:'))?>
        <?php foreach ($this->contributors as $contributor) { ?>
            <?=$this->user($contributor)?>
        <?php } ?>
    </p>
<?php } ?>